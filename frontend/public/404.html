<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script>
      (function () {
        var pathSegmentsToKeep = 1; // keep "/SG" on GitHub Pages
        var l = window.location;
        var segments = l.pathname.replace(/^\//, "").split("/");
        var baseSegments = segments.slice(0, pathSegmentsToKeep);
        var appSegments = segments.slice(pathSegmentsToKeep);
        var origin =
          l.protocol +
          "//" +
          l.hostname +
          (l.port ? ":" + l.port : "");
        var basePath = "/" + baseSegments.join("/");
        if (basePath === "/") basePath = "";

        var targetPath = "/?/";
        if (appSegments[0] === "user" && appSegments[1]) {
          targetPath = "/user/?uid=" + appSegments[1];
        } else if (appSegments.length === 0 || appSegments[0] === "") {
          targetPath = "/";
        } else {
          targetPath += appSegments.join("/");
        }

        var newUrl = origin + basePath + targetPath;

        if (l.search) {
          newUrl += newUrl.indexOf("?") > -1 ? "&" : "?";
          newUrl += l.search.slice(1).replace(/&/g, "~and~");
        }
        if (l.hash) {
          newUrl += l.hash;
        }

        window.location.replace(newUrl);
      })();
    </script>
  </head>
  <body></body>
</html>
